# å‰è¨€
>æ–‡æœ¬å·²æ”¶å½•è‡³æˆ‘çš„GitHubä»“åº“ï¼Œæ¬¢è¿Starï¼šhttps://github.com/bin392328206/six-finger                             
> **ç§ä¸€æ£µæ ‘æœ€å¥½çš„æ—¶é—´æ˜¯åå¹´å‰ï¼Œå…¶æ¬¡æ˜¯ç°åœ¨**   
>æˆ‘çŸ¥é“å¾ˆå¤šäººä¸ç©**qq**äº†,ä½†æ˜¯æ€€æ—§ä¸€ä¸‹,æ¬¢è¿åŠ å…¥å…­è„‰ç¥å‰‘Javaèœé¸Ÿå­¦ä¹ ç¾¤ï¼Œç¾¤èŠå·ç ï¼š**549684836** é¼“åŠ±å¤§å®¶åœ¨æŠ€æœ¯çš„è·¯ä¸Šå†™åšå®¢
## çµ®å¨ 
ä»Šå¤©æˆ‘ä»¬è®²å¹¶å‘ç¼–ç¨‹çš„åŸºç¡€ï¼Œä¹Ÿå°±æ˜¯å¤šçº¿ç¨‹çš„åŸºç¡€ï¼Œæ²¡æœ‰å¤šçº¿ç¨‹çš„è¯ï¼Œå°±æ²¡æœ‰å¹¶å‘å¯¹å§ï¼Œä¸‹é¢æ˜¯å‰é¢çš„ç« èŠ‚é“¾æ¥ï¼š  
- [ğŸ”¥å²ä¸Šæœ€å…¨çš„Javaå¹¶å‘ç³»åˆ—ä¹‹å¹¶å‘ç¼–ç¨‹çš„æŒ‘æˆ˜](https://juejin.im/post/5dfb1ca26fb9a0160b63827f)  
- [ğŸ”¥å²ä¸Šæœ€å…¨çš„Javaå¹¶å‘ç³»åˆ—ä¹‹Javaå¹¶å‘æœºåˆ¶çš„åº•å±‚å®ç°åŸç†](https://juejin.im/post/5dfb3a27e51d4558181d35b0)    
- [ğŸ”¥å²ä¸Šæœ€å…¨çš„Javaå¹¶å‘ç³»åˆ—ä¹‹Javaå†…å­˜æ¨¡å‹](https://juejin.im/post/5dfc3dadf265da339b5001dd)  
## çº¿ç¨‹çš„ç®€ä»‹
- ä»€ä¹ˆæ˜¯çº¿ç¨‹
    >çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿèƒ½å¤Ÿè¿›è¡Œè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ã€‚å®ƒè¢«åŒ…å«åœ¨è¿›ç¨‹ä¹‹ä¸­ï¼Œæ˜¯è¿›ç¨‹ä¸­çš„å®é™…è¿ä½œå•ä½ã€‚ä¸€æ¡çº¿ç¨‹æŒ‡çš„æ˜¯è¿›ç¨‹ä¸­ä¸€ä¸ªå•ä¸€é¡ºåºçš„æ§åˆ¶æµï¼Œä¸€ä¸ªè¿›ç¨‹ä¸­å¯ä»¥å¹¶å‘å¤šä¸ªçº¿ç¨‹ï¼Œæ¯æ¡çº¿ç¨‹å¹¶è¡Œæ‰§è¡Œä¸åŒçš„ä»»åŠ¡ã€‚

- ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¤šçº¿ç¨‹
    >ç›®å‰çš„å¤„ç†å™¨æ ¸å¿ƒè¶Šæ¥è¶Šå¤šï¼Œä½¿ç”¨å¤šçº¿ç¨‹èƒ½æœ‰æ›´å¿«çš„å“åº”æ—¶é—´ï¼Œå¹¶èƒ½æœ‰æ›´å¥½çš„ç¼–ç¨‹æ¨¡å‹ã€‚

- çº¿ç¨‹ä¼˜å…ˆçº§
    >ç°ä»£æ“ä½œç³»ç»ŸåŸºæœ¬é‡‡ç”¨æ—¶åˆ†çš„å½¢å¼è°ƒåº¦è¿è¡Œçš„çº¿ç¨‹ï¼Œæ“ä½œç³»ç»Ÿåˆ†å‡ºæ¯ä¸€ä¸ªæ—¶é—´ç‰‡ä¼šæ ¹æ®çº¿ç¨‹çš„ä¼˜å…ˆçº§æ¥åˆ†é…ï¼Œä¼˜å…ˆçº§è¶Šé«˜çš„æœ€å…ˆè·å–æ‰§è¡Œèµ„æºã€‚

åœ¨Javaçº¿ç¨‹ä¸­ï¼Œé€šè¿‡ä¸€ä¸ªæ•´å‹æˆå‘˜å˜é‡priorityæ¥æ§åˆ¶ä¼˜å…ˆçº§ï¼Œä¼˜å…ˆçº§çš„èŒƒå›´ä»1~10ï¼Œåœ¨çº¿ç¨‹æ„å»ºçš„æ—¶å€™å¯ä»¥é€šè¿‡setPriority(int)æ–¹æ³•æ¥ä¿®æ”¹ä¼˜å…ˆçº§ï¼Œé»˜è®¤ä¼˜å…ˆçº§æ˜¯5ï¼Œä¼˜å…ˆçº§é«˜çš„çº¿ç¨‹åˆ†é…æ—¶é—´ç‰‡çš„æ•°é‡è¦å¤šäºä¼˜å…ˆçº§ä½çš„çº¿ç¨‹ã€‚

### çº¿ç¨‹çš„çŠ¶æ€
- NEW åˆå§‹çŠ¶æ€
- RUNNABLE è¿è¡ŒçŠ¶æ€
- BLOCKED é˜»å¡çŠ¶æ€
- WAITING ç­‰å¾…çŠ¶æ€
- TIME_WAITING è¶…æ—¶ç­‰å¾…çŠ¶æ€
- TERMINATED ç»ˆæ­¢çŠ¶æ€
![](https://user-gold-cdn.xitu.io/2019/12/21/16f26ce52c37e554?w=856&h=583&f=png&s=175122)

## Theadç±»æºç è§£è¯»

Javaæ‰€æœ‰å¤šçº¿ç¨‹çš„å®ç°ï¼Œå‡é€šè¿‡å°è£…Threadç±»å®ç°ï¼Œæ‰€ä»¥æ·±å…¥Threadç±»ï¼Œå¯¹æ·±å…¥ç†è§£javaå¤šçº¿ç¨‹å¾ˆæœ‰å¿…è¦

### ç»§æ‰¿å…³ç³» 

![](https://user-gold-cdn.xitu.io/2019/12/21/16f26db2f94e8861?w=646&h=455&f=png&s=15483)

![](https://user-gold-cdn.xitu.io/2019/12/21/16f26dbd734d2d77?w=1521&h=590&f=png&s=153002)

### ä¸»è¦å±æ€§

```

/*
 * çº¿ç¨‹åå­—ï¼Œé€šè¿‡æ„é€ å‚æ•°æ¥æŒ‡å®š  
 */
private volatile String name;

/*
 * è¡¨ç¤ºçº¿ç¨‹çš„ä¼˜å…ˆçº§,ä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šä¼˜å…ˆè¢«æ‰§è¡Œï¼ˆæœ€å¤§å€¼ä¸º10ï¼Œæœ€å°å€¼ä¸º1ï¼Œé»˜è®¤å€¼ä¸º5ï¼‰
 */
private int  priority;

/*
 * çº¿ç¨‹æ˜¯å¦æ˜¯å®ˆæŠ¤çº¿ç¨‹:å½“æ‰€æœ‰éå®ˆæŠ¤è¿›ç¨‹ç»“æŸæˆ–æ­»äº¡åï¼Œç¨‹åºå°†åœæ­¢
 */   
private boolean  daemon = false;

/*
 * å°†è¦æ‰§è¡Œçš„ä»»åŠ¡
 */  
private Runnable target;

/*
 * çº¿ç¨‹ç»„è¡¨ç¤ºä¸€ä¸ªçº¿ç¨‹çš„é›†åˆã€‚æ­¤å¤–ï¼Œçº¿ç¨‹ç»„ä¹Ÿå¯ä»¥åŒ…å«å…¶ä»–çº¿ç¨‹ç»„ã€‚çº¿ç¨‹ç»„æ„æˆä¸€æ£µæ ‘ï¼Œåœ¨æ ‘ä¸­ï¼Œé™¤äº†åˆå§‹çº¿ç¨‹ç»„å¤–ï¼Œæ¯ä¸ªçº¿ç¨‹ç»„éƒ½æœ‰ä¸€ä¸ªçˆ¶çº¿ç¨‹ç»„ã€‚
 */ 
private ThreadGroup group;

/*
 * Thread ID
 */ 
private long tid;

/*
 * ç”¨æ¥ç”ŸæˆThread IDä½¿ç”¨
 */ 
private static long threadSeqNumber;

/*
 * ç¬¬å‡ ä¸ªçº¿ç¨‹ï¼Œåœ¨initåˆå§‹åŒ–çº¿ç¨‹çš„æ—¶å€™ç”¨æ¥èµ‹ç»™thread.name
 */ 
private static int threadInitNumber


/*
 * çº¿ç¨‹ä»åˆ›å»ºåˆ°æœ€ç»ˆçš„æ¶ˆäº¡ï¼Œè¦ç»å†è‹¥å¹²ä¸ªçŠ¶æ€ã€‚ 
 * ä¸€èˆ¬æ¥è¯´ï¼Œçº¿ç¨‹åŒ…æ‹¬ä»¥ä¸‹è¿™å‡ ä¸ªçŠ¶æ€ï¼šåˆ›å»º(new)ã€å°±ç»ª(runnable)ã€è¿è¡Œ(running)ã€é˜»å¡(blocked)ã€time waitingã€waitingã€æ¶ˆäº¡ï¼ˆdeadï¼‰
 */
private volatile int threadStatus = 0;
```
### æ„é€ å‡½æ•°

```
//ä¼ å…¥Runnableæ¥å£å®ç°
Thread(Runnable target)
//ä¼ å…¥Runnableæ¥å£å®ç°,ä¼ å…¥çº¿ç¨‹å
Thread(Runnable target, String name) 
//è®¾ç½®å½“å‰çº¿ç¨‹ç”¨æˆ·ç»„
Thread(ThreadGroup group, Runnable target)
//è®¾ç½®ç”¨æˆ·ç»„ï¼Œä¼ å…¥çº¿ç¨‹å
Thread(ThreadGroup group, Runnable target, String name)
//è®¾ç½®ç”¨æˆ·ç»„ï¼Œä¼ å…¥çº¿ç¨‹åï¼Œè®¾ç½®å½“å‰çº¿ç¨‹æ ˆå¤§å°
Thread(ThreadGroup group, Runnable target, String name, long stackSize) 
```
è¿™è¾¹æä¸€ä¸‹åˆ›å»ºçº¿ç¨‹çš„å‡ ç§æ–¹å¼ï¼Œå¤§ä½“æ¥è¯´æœ‰4ç§å§ï¼Œæˆ‘è¿™è¾¹ä»£ç å°±ä¸ä¸Šäº†ï¼Œä¸ç„¶å°±å†™çš„å¤ªé•¿äº†
- ç¬¬ä¸€ç§ï¼Œä¾¿æ˜¯ç»§ç»­Threadç±»  ï¼Œé‡å†™runæ–¹æ³•ï¼Œå…¶å®è¿™ä¸ªrunæ–¹æ³•ä¹Ÿæ˜¯é‡å†™Runnableçš„ï¼Œ
- ç¬¬äºŒç§ï¼Œä¾¿æ˜¯å»å®ç°Runnable,ä¹Ÿæ˜¯ä¸€æ ·
- ç¬¬ä¸‰ç§æ˜¯ é€šè¿‡FutureTask æ¥åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œè¿™ä¸ªçš„åŸç†æ˜¯å•¥å‘¢ï¼Ÿå…¶å®ä¸€æ ·è¿™ä¸ªç±»çš„çˆ¶ç±»ç»§æ‰¿Runnableï¼Œè¿™ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„ä¸€ç‚¹æ˜¯çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œå¯ä»¥æœ‰è¿”å›å€¼è¿”å›ã€‚
- ç¬¬å››ä¸ªå°±æ˜¯é€šè¿‡çº¿ç¨‹æ± æ¥åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼ˆç”Ÿäº§ç¯å¢ƒéƒ½è¿™ä¹ˆç”¨ï¼‰


çº¿ç¨‹é»˜è®¤åç§°ç”Ÿäº§è§„åˆ™ï¼š

```
// å½“å‰ç¼ºçœçº¿ç¨‹åï¼š"Thread-" + nextThreadNum()
public Thread(Runnable target) {
        init(null, target, "Thread-" + nextThreadNum(), 0);
    }
---
// nextThreadNum åŒæ­¥æ–¹æ³•ï¼Œçº¿ç¨‹å®‰å…¨ï¼Œä¸ä¼šå‡ºç°é‡å¤çš„threadInitNumber
private static int threadInitNumber;
private static synchronized int nextThreadNum() {
    return threadInitNumber++;
}

```
çº¿ç¨‹ç§æœ‰åŒ–å®ç°ï¼Œå¥½å¥½è®²è®²è¿™ä¸ªåˆå§‹åŒ–æ–¹æ³•


![](https://user-gold-cdn.xitu.io/2019/12/21/16f275f5c194998e?w=1694&h=525&f=png&s=149452)

```
 
/**
     * Initializes a Thread.
     *
     * @param g the Thread group
     * @param target the object whose run() method gets called
     * @param name the name of the new Thread
     * @param stackSize the desired stack size for the new thread, or
     *        zero to indicate that this parameter is to be ignored.
     * @param acc the AccessControlContext to inherit, or
     *            AccessController.getContext() if null
     */
    private void init(ThreadGroup g, Runnable target, String name,
                      long stackSize, AccessControlContext acc) {
		//çº¿ç¨‹å¿…é¡»è®¾ç½®åç§°ï¼Œå¦åˆ™æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸
        if (name == null) {
            throw new NullPointerException("name cannot be null");
        }
 
        this.name = name.toCharArray();
 
		//çˆ¶çº¿ç¨‹
        Thread parent = currentThread();
        SecurityManager security = System.getSecurityManager();
        //å¦‚æœçº¿ç¨‹ç»„ä¸ºnull
        if (g == null) {
            /* Determine if it's an applet or not */
            //å¦‚æœæœ‰å®‰å…¨ç®¡ç†å™¨ï¼Œä»å®‰å…¨ç®¡ç†å™¨è·å¾—çº¿ç¨‹ç»„
            /* If there is a security manager, ask the security manager
               what to do. */
            if (security != null) {
                g = security.getThreadGroup();
            }
            //å¦‚æœå®‰å…¨ç®¡ç†å™¨ä¹Ÿä¸çŸ¥é“çº¿ç¨‹ç»„ï¼Œé‚£ä¹ˆä»çˆ¶çº¿ç¨‹è·å–çº¿ç¨‹ç»„ï¼Œä¹Ÿå°±æ˜¯çº¿ç¨‹å¿…é¡»å½’å±äºæŸä¸ªçº¿ç¨‹ç»„
            /* If the security doesn't have a strong opinion of the matter
               use the parent thread group. */
            if (g == null) {
                g = parent.getThreadGroup();
            }
        }
 
        /* checkAccess regardless of whether or not threadgroup is
           explicitly passed in. */
        g.checkAccess();
 
        /*
         * Do we have the required permissions?
         //æ ¡éªŒæ˜¯å¦æœ‰å®‰å…¨æ ¡éªŒæƒåˆ©ï¼Œå¦‚æœé‡å†™äº†getContextClassLoaderå’ŒsetContextClassLoader
         */
        if (security != null) {
            if (isCCLOverridden(getClass())) {
                security.checkPermission(SUBCLASS_IMPLEMENTATION_PERMISSION);
            }
        }
        //çº¿ç¨‹ç»„æ·»åŠ æœªå¯åŠ¨çº¿ç¨‹
        g.addUnstarted();
 
        this.group = g;
	  /* è®¾ç½®å½“å‰çº¿ç¨‹æ˜¯å¦ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œé»˜è®¤æ˜¯å’Œå½“å‰ç±»çš„ThreadGroupè®¾ç½®ç›¸
        * åŒã€‚å¦‚æœæ˜¯å®ˆæŠ¤çº¿ç¨‹çš„è¯ï¼Œå½“å‰çº¿ç¨‹ç»“æŸä¼šéšç€ä¸»çº¿ç¨‹çš„é€€å‡ºè€Œé€€å‡ºã€‚
        *jvmé€€å‡ºçš„æ ‡è¯†æ˜¯ï¼Œå½“å‰ç³»ç»Ÿæ²¡æœ‰æ´»è·ƒçš„éå®ˆæŠ¤çº¿ç¨‹ã€‚
        */
        this.daemon = parent.isDaemon();
        this.priority = parent.getPriority();
        if (security == null || isCCLOverridden(parent.getClass()))
            this.contextClassLoader = parent.getContextClassLoader();
        else
            this.contextClassLoader = parent.contextClassLoader;
        this.inheritedAccessControlContext =
                acc != null ? acc : AccessController.getContext();
        this.target = target;
        setPriority(priority);
        if (parent.inheritableThreadLocals != null)
            this.inheritableThreadLocals =
                ThreadLocal.createInheritedMap(parent.inheritableThreadLocals);
        /*è®¾ç½®æŒ‡å®šçš„æ ˆå¤§å°ï¼Œå¦‚æœæœªæŒ‡å®šå¤§å°ï¼Œå°†åœ¨jvm åˆå§‹åŒ–å‚æ•°ä¸­å£°æ˜ï¼šXsså‚æ•°è¿›è¡ŒæŒ‡å®š*/
        this.stackSize = stackSize;
        
        /* Set thread ID */
        tid = nextThreadID();
    }
```
### startæ–¹æ³•

![](https://user-gold-cdn.xitu.io/2019/12/21/16f27673c1f8f21a?w=1714&h=397&f=png&s=118180)
ä»æºç ä¸­å¾—å‡ºï¼šä¸€ä¸ªçº¿ç¨‹ä¸€æ—¦å·²ç»è¢«startäº†å°±ä¸èƒ½å†æ¬¡æ‰§è¡Œstartæ–¹æ³•ã€‚è¢«startè¿‡çš„çº¿ç¨‹ï¼Œçº¿ç¨‹çŠ¶æ€å·²ç»ä¸æ˜¯0äº†

```
/*  å¯¼è‡´æ­¤çº¿ç¨‹å¼€å§‹æ‰§è¡Œ; Java Virtual Machineè°ƒç”¨æ­¤çº¿ç¨‹çš„runæ–¹æ³•ã€‚
    ç»“æœæ˜¯ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶è¿è¡Œï¼šå½“å‰çº¿ç¨‹ï¼ˆä»è°ƒç”¨è¿”å›åˆ°startæ–¹æ³•ï¼‰å’Œå¦ä¸€ä¸ªçº¿ç¨‹ï¼ˆæ‰§è¡Œå…¶runæ–¹æ³•ï¼‰ã€‚
    ä¸æ­¢ä¸€æ¬¡å¯åŠ¨çº¿ç¨‹æ°¸è¿œä¸åˆæ³•ã€‚
    ç‰¹åˆ«æ˜¯ï¼Œä¸€æ—¦å®Œæˆæ‰§è¡Œï¼Œçº¿ç¨‹å¯èƒ½æ— æ³•é‡æ–°å¯åŠ¨ã€‚
    @exception IllegalThreadStateExceptionå¦‚æœçº¿ç¨‹å·²ç»å¯åŠ¨ã€‚
    @see #runï¼ˆï¼‰
    @see #stopï¼ˆï¼‰*/

 public synchronized void start() {
        /**
         * This method is not invoked for the main method thread or "system"
         * group threads created/set up by the VM. Any new functionality added
         * to this method in the future may have to also be added to the VM.
         *
         * A zero status value corresponds to state "NEW".
         */
        //æ­¤åˆ¤æ–­å½“å‰çº¿ç¨‹åªèƒ½è¢«å¯åŠ¨ä¸€æ¬¡ï¼Œä¸èƒ½è¢«é‡å¤å¯åŠ¨
        if (threadStatus != 0)
            throw new IllegalThreadStateException();

        /* Notify the group that this thread is about to be started
         * so that it can be added to the group's list of threads
         * and the group's unstarted count can be decremented. */
        /*é€šçŸ¥ç»„è¯¥çº¿ç¨‹å³å°†å¯åŠ¨
          *è¿™æ ·å®ƒå°±å¯ä»¥æ·»åŠ åˆ°ç»„çš„çº¿ç¨‹åˆ—è¡¨ä¸­
         *å¹¶ä¸”è¯¥ç»„çš„æœªå¯åŠ¨è®¡æ•°å¯ä»¥é€’å‡ã€‚*/
        group.add(this);

        boolean started = false;
        try {
            start0();
            started = true;
        } finally {
            try {
                // å¦‚æœçº¿ç¨‹å¯åŠ¨å¤±è´¥ï¼Œä»çº¿ç¨‹ç»„é‡Œé¢ç§»é™¤è¯¥çº¿ç¨‹
                if (!started) {
                    group.threadStartFailed(this);
                }
            } catch (Throwable ignore) {
                /* do nothing. If start0 threw a Throwable then
                  it will be passed up the call stack */
            }
        }
    }
```
å…¶å®ï¼Œè¿™ä¸ªæºç ä¹Ÿç®€å•ï¼Œå°±æ˜¯å¯åŠ¨çº¿ç¨‹ ç„¶åè®©é‚£ä¸ªç»„é‡Œé¢å¾…å¯åŠ¨çš„çº¿ç¨‹å‡1ï¼Œå¦‚æœå¤±è´¥ï¼Œå°±æŠŠä»–åŠ å…¥åˆ°å¤±è´¥çš„æ•°ç»„é‡Œé¢ã€‚
### join() æ–¹æ³•æºç åˆ†æï¼š
è®©çˆ¶çº¿ç¨‹ç­‰å¾…å­çº¿ç¨‹ç»“æŸä¹‹åæ‰èƒ½ç»§ç»­è¿è¡Œã€‚

```
/**
     * Waits at most {@code millis} milliseconds for this thread to
     * die. A timeout of {@code 0} means to wait forever.
     *
     * <p> This implementation uses a loop of {@code this.wait} calls
     * conditioned on {@code this.isAlive}. As a thread terminates the
     * {@code this.notifyAll} method is invoked. It is recommended that
     * applications not use {@code wait}, {@code notify}, or
     * {@code notifyAll} on {@code Thread} instances.
     *
     * @param  millis
     *         the time to wait in milliseconds
     *
     * @throws  IllegalArgumentException
     *          if the value of {@code millis} is negative
     *
     * @throws  InterruptedException
     *          if any thread has interrupted the current thread. The
     *          <i>interrupted status</i> of the current thread is
     *          cleared when this exception is thrown.
     */
    public final synchronized void join(long millis) throws InterruptedException {
        long base = System.currentTimeMillis();
        long now = 0;

        if (millis < 0) {
            throw new IllegalArgumentException("timeout value is negative");
        }

        if (millis == 0) {
        // å¦‚æœmillis == 0 çº¿ç¨‹å°†ä¸€ç›´ç­‰å¾…ä¸‹å»
            while (isAlive()) {
                wait(0);
            }
        } else {
            // æŒ‡å®šäº†millis ï¼Œç­‰å¾…æŒ‡å®šæ—¶é—´ä»¥åï¼Œä¼šbreakå½“å‰çº¿ç¨‹
            while (isAlive()) {
                long delay = millis - now;
                if (delay <= 0) {
                    break;
                }
                wait(delay);
                now = System.currentTimeMillis() - base;
            }
        }
    }
```

![](https://user-gold-cdn.xitu.io/2019/12/21/16f27701cd0f0e29?w=1366&h=382&f=png&s=96903)
å…¶å®è¿™ä¸ªä¹Ÿç®€å•ï¼Œéšä¾¿è¯´è¯´ï¼Œé¦–å…ˆJoinæ–¹æ³•å‘¢ï¼Ÿæœ‰å‡ ä¸ªé‡è½½çš„æ–¹æ³•ï¼Œå¦‚æœä½ ä¸ä¼ å‚æ•°ï¼Œé‚£ä¹ˆå°±è¡¨ç¤ºä½ çš„è¶…æ—¶æ—¶é—´æ˜¯æ°¸ä¸è¿‡æœŸï¼Œåªè¦è°ƒç”¨joinæ–¹æ³•çš„çº¿ç¨‹ä¸æ‰§è¡Œå®Œæˆï¼Œå½“å‰çº¿ç¨‹å°±ä¼šä¸€ç›´ç­‰å¾…ï¼Œå…¶åº•å±‚å®ç°è¿˜æ˜¯Java object çš„waitæ–¹æ³•

æ³¨æ„ç‚¹ï¼š

- joinæ–¹æ³•æ˜¯é€šè¿‡waitæ–¹æ³•å®ç°çš„ï¼Œæ‰€ä»¥ä¼šé‡Šæ”¾å¯¹è±¡é”ã€‚

- è°ƒç”¨æ–¹çº¿ç¨‹çŠ¶æ€ä¸ºWAITINGã€‚

- joinéœ€è¦åœ¨startä¹‹åè°ƒç”¨

### interruptæ–¹æ³•
çº¿ç¨‹ä¸­æ–­åœ¨ä¹‹å‰çš„ç‰ˆæœ¬æœ‰stopæ–¹æ³•ï¼Œä½†æ˜¯è¢«è®¾ç½®è¿‡æ—¶äº†ã€‚ç°åœ¨å·²ç»æ²¡æœ‰å¼ºåˆ¶çº¿ç¨‹ç»ˆæ­¢çš„æ–¹æ³•äº†ï¼

ç”±äºstopæ–¹æ³•å¯ä»¥è®©ä¸€ä¸ªçº¿ç¨‹Aç»ˆæ­¢æ‰å¦ä¸€ä¸ªçº¿ç¨‹B
- è¢«ç»ˆæ­¢çš„çº¿ç¨‹Bä¼šç«‹å³é‡Šæ”¾é”ï¼Œè¿™å¯èƒ½ä¼šè®©å¯¹è±¡å¤„äºä¸ä¸€è‡´çš„çŠ¶æ€ã€‚
- çº¿ç¨‹Aä¹Ÿä¸çŸ¥é“çº¿ç¨‹Bä»€ä¹ˆæ—¶å€™èƒ½å¤Ÿè¢«ç»ˆæ­¢æ‰ï¼Œä¸‡ä¸€çº¿ç¨‹Bè¿˜å¤„ç†è¿è¡Œè®¡ç®—é˜¶æ®µï¼Œçº¿ç¨‹Aè°ƒç”¨stopæ–¹æ³•å°†çº¿ç¨‹Bç»ˆæ­¢ï¼Œé‚£å°±å¾ˆæ— è¾œäº†~

æ€»è€Œè¨€ä¹‹ï¼ŒStopæ–¹æ³•å¤ªæš´åŠ›äº†ï¼Œä¸å®‰å…¨ï¼Œæ‰€ä»¥è¢«è®¾ç½®è¿‡æ—¶äº†ã€‚

æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨çš„æ˜¯interruptæ¥è¯·æ±‚ç»ˆæ­¢çº¿ç¨‹~

- è¦æ³¨æ„çš„æ˜¯ï¼šinterruptä¸ä¼šçœŸæ­£åœæ­¢ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ƒä»…ä»…æ˜¯ç»™è¿™ä¸ªçº¿ç¨‹å‘äº†ä¸€ä¸ªä¿¡å·å‘Šè¯‰å®ƒï¼Œå®ƒåº”è¯¥è¦ç»“æŸäº†(æ˜ç™½è¿™ä¸€ç‚¹éå¸¸é‡è¦ï¼)
- ä¹Ÿå°±æ˜¯è¯´ï¼šJavaè®¾è®¡è€…å®é™…ä¸Šæ˜¯æƒ³çº¿ç¨‹è‡ªå·±æ¥ç»ˆæ­¢ï¼Œé€šè¿‡ä¸Šé¢çš„ä¿¡å·ï¼Œå°±å¯ä»¥åˆ¤æ–­å¤„ç†ä»€ä¹ˆä¸šåŠ¡äº†ã€‚
- å…·ä½“åˆ°åº•ä¸­æ–­è¿˜æ˜¯ç»§ç»­è¿è¡Œï¼Œåº”è¯¥ç”±è¢«é€šçŸ¥çš„çº¿ç¨‹è‡ªå·±å¤„ç†

```
Thread t1 = new Thread( new Runnable(){
    public void run(){
        // è‹¥æœªå‘ç”Ÿä¸­æ–­ï¼Œå°±æ­£å¸¸æ‰§è¡Œä»»åŠ¡
        while(!Thread.currentThread.isInterrupted()){
            // æ­£å¸¸ä»»åŠ¡ä»£ç â€¦â€¦
        }
        // ä¸­æ–­çš„å¤„ç†ä»£ç â€¦â€¦
        doSomething();
    }
} ).start();
```
å†æ¬¡è¯´æ˜ï¼šè°ƒç”¨interrupt()å¹¶ä¸æ˜¯è¦çœŸæ­£ç»ˆæ­¢æ‰å½“å‰çº¿ç¨‹ï¼Œä»…ä»…æ˜¯è®¾ç½®äº†ä¸€ä¸ªä¸­æ–­æ ‡å¿—ã€‚è¿™ä¸ªä¸­æ–­æ ‡å¿—å¯ä»¥ç»™æˆ‘ä»¬ç”¨æ¥åˆ¤æ–­ä»€ä¹ˆæ—¶å€™è¯¥å¹²ä»€ä¹ˆæ´»ï¼ä»€ä¹ˆæ—¶å€™ä¸­æ–­ç”±æˆ‘ä»¬è‡ªå·±æ¥å†³å®šï¼Œè¿™æ ·å°±å¯ä»¥å®‰å…¨åœ°ç»ˆæ­¢çº¿ç¨‹äº†ï¼


```
//é™¤éä¸­æ–­è‡ªå·±ï¼ŒcheckAccesséƒ½å°†è¢«è°ƒç”¨
    /**
     * Interrupts this thread.
     *
     * <p> Unless the current thread is interrupting itself, which is
     * always permitted, the {@link #checkAccess() checkAccess} method
     * of this thread is invoked, which may cause a {@link
     * SecurityException} to be thrown.
     *
	 //å¦‚æœä¸€ä¸ªçº¿ç¨‹é˜»å¡åœ¨watæ–¹æ³•ï¼Œæˆ–è€…çº¿ç¨‹çš„joinæ–¹æ³•ï¼Œå†æˆ–è€…sleepæ–¹æ³•ä¸Šï¼Œ
	 //çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€è¢«æ¸…ç©ºè®¾ç½®ä¸ºfalseï¼Œå¹¶ä¸”è¢«interruptçš„çº¿ç¨‹å°†æ”¶åˆ°ä¸€ä¸ªä¸­æ–­å¼‚å¸¸ã€‚
     * <p> If this thread is blocked in an invocation of the {@link
     * Object#wait() wait()}, {@link Object#wait(long) wait(long)}, or {@link
     * Object#wait(long, int) wait(long, int)} methods of the {@link Object}
     * class, or of the {@link #join()}, {@link #join(long)}, {@link
     * #join(long, int)}, {@link #sleep(long)}, or {@link #sleep(long, int)},
     * methods of this class, then its interrupt status will be cleared and it
     * will receive an {@link InterruptedException}.
     *
	 //å¦‚æœçº¿ç¨‹é˜»å¡åœ¨IOæ“ä½œï¼Œchannelå°†è¢«å…³é—­ï¼Œå¹¶ä¸”çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ä¼šè¢«è®¾ç½®ä¸ºtrueï¼Œ
	 //å¹¶ä¸”è¢«interruptçš„çº¿ç¨‹å°†æ”¶åˆ°ä¸€ä¸ªClosedByInterruptExceptionå¼‚å¸¸ã€‚
     * <p> If this thread is blocked in an I/O operation upon an {@link
     * java.nio.channels.InterruptibleChannel InterruptibleChannel}
     * then the channel will be closed, the thread's interrupt
     * status will be set, and the thread will receive a {@link
     * java.nio.channels.ClosedByInterruptException}.
     *
	 //å¦‚æœçº¿ç¨‹é˜»å¡åœ¨selectoræ–¹æ³•ï¼Œä¸­æ–­çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€å°†è®¾ç½®ä¸ºtrueï¼Œå¹¶ä¸”ä»selectæ“ä½œç«‹å³è¿”å›ï¼Œ
	 //åªæœ‰selectorçš„wakeupæ–¹æ³•è¢«è°ƒç”¨å¯èƒ½è¿”å›ä¸€ä¸ªé0å€¼ã€‚
     * <p> If this thread is blocked in a {@link java.nio.channels.Selector}
     * then the thread's interrupt status will be set and it will return
     * immediately from the selection operation, possibly with a non-zero
     * value, just as if the selector's {@link
     * java.nio.channels.Selector#wakeup wakeup} method were invoked.
     *//å¦‚æœä¸æ˜¯ä¸Šé¢è¯´çš„å‡ ç§æƒ…å†µï¼Œçº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€å°†è¢«è®¾ç½®ã€‚
     * <p> If none of the previous conditions hold then this thread's interrupt
     * status will be set. </p>
     *
     * <p> Interrupting a thread that is not alive need not have any effect.
     *
     * @throws  SecurityException
     *          if the current thread cannot modify this thread
     *
     * @revised 6.0
     * @spec JSR-51
     */
    public void interrupt() {
        if (this != Thread.currentThread())
            checkAccess();
        synchronized (blockerLock) {
            Interruptible b = blocker;
            if (b != null) {
                interrupt0();           // Just to set the interrupt flag
                b.interrupt(this);
                return;
            }
        }
        interrupt0();
    }
```
interruptçº¿ç¨‹ä¸­æ–­è¿˜æœ‰å¦å¤–ä¸¤ä¸ªæ–¹æ³•(æ£€æŸ¥è¯¥çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­)ï¼š

- é™æ€æ–¹æ³•interrupted()-->ä¼šæ¸…é™¤ä¸­æ–­æ ‡å¿—ä½
- å®ä¾‹æ–¹æ³•isInterrupted()-->ä¸ä¼šæ¸…é™¤ä¸­æ–­æ ‡å¿—ä½
### sleepæ–¹æ³•(long millis)

```
public static native void sleep(long millis) throws InterruptedException;

```
æ³¨æ„ç‚¹ï¼š

- sleepæ˜¯æŒ‡çº¿ç¨‹è¢«è°ƒç”¨æ—¶ï¼Œå ç€CPUä¸å·¥ä½œï¼Œå½¢è±¡åœ°è¯´æ˜ä¸ºâ€œå ç€CPUç¡è§‰â€ï¼Œæ­¤æ—¶ï¼Œç³»ç»Ÿçš„CPUéƒ¨åˆ†èµ„æºè¢«å ç”¨ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•è¿›å…¥ã€‚

- sleepæ–¹æ³•ä¸ä¼šé‡Šæ”¾é”ã€‚

### yield()æ–¹æ³•

```
public static native void yield();
```

æ³¨æ„ç‚¹ï¼š

- è°ƒç”¨yieldæ–¹æ³•ä¼šè®©å½“å‰çº¿ç¨‹äº¤å‡ºCPUæƒé™ï¼Œè®©æ‹¥æœ‰ç›¸åŒä¼˜å…ˆçº§çš„çº¿ç¨‹æœ‰è·å–CPUæ‰§è¡Œæ—¶é—´çš„æœºä¼š
- è°ƒç”¨yieldæ–¹æ³•å¹¶ä¸ä¼šè®©çº¿ç¨‹è¿›å…¥BLOCKEDçŠ¶æ€ï¼Œè€Œæ˜¯è®©çº¿ç¨‹é‡å›RUNNABLEçŠ¶æ€ï¼Œ ä½†ä¸èƒ½ä¿è¯è¿…é€Ÿè½¬æ¢ã€‚ï¼ˆè‡ªå·±ä¹Ÿå¯ä»¥å†æ¬¡ç«äº‰çš„ï¼‰
- ä¸ä¼šé‡Šæ”¾é”

## ç»“å°¾

ç¬¬å››ç« çš„ç¬¬ä¸€å°èŠ‚è®²å®Œäº†ï¼Œè®²çš„æ˜¯Thread,ä¸æ˜¯å¾ˆæ·±ï¼Œè·Ÿç€å­¦è¿˜æ˜¯å¯ä»¥çš„ï¼Œå¥½äº†ï¼Œä»Šå¤©å°±åˆ°è¿™é‡Œäº†

> å› ä¸ºåšä¸»ä¹Ÿæ˜¯ä¸€ä¸ªå¼€å‘èŒæ–° æˆ‘ä¹Ÿæ˜¯ä¸€è¾¹å­¦ä¸€è¾¹å†™ æˆ‘æœ‰ä¸ªç›®æ ‡å°±æ˜¯ä¸€å‘¨ äºŒåˆ°ä¸‰ç¯‡ å¸Œæœ›èƒ½åšæŒä¸ªä¸€å¹´å§ å¸Œæœ›å„ä½å¤§ä½¬å¤šææ„è§ï¼Œè®©æˆ‘å¤šå­¦ä¹ ï¼Œä¸€èµ·è¿›æ­¥ã€‚
## æ—¥å¸¸æ±‚èµ
> å¥½äº†å„ä½ï¼Œä»¥ä¸Šå°±æ˜¯è¿™ç¯‡æ–‡ç« çš„å…¨éƒ¨å†…å®¹äº†ï¼Œèƒ½çœ‹åˆ°è¿™é‡Œçš„äººå‘€ï¼Œéƒ½æ˜¯**çœŸç²‰**ã€‚

> åˆ›ä½œä¸æ˜“ï¼Œå„ä½çš„æ”¯æŒå’Œè®¤å¯ï¼Œå°±æ˜¯æˆ‘åˆ›ä½œçš„æœ€å¤§åŠ¨åŠ›ï¼Œæˆ‘ä»¬ä¸‹ç¯‡æ–‡ç« è§

>å…­è„‰ç¥å‰‘ | æ–‡ ã€åŸåˆ›ã€‘å¦‚æœæœ¬ç¯‡åšå®¢æœ‰ä»»ä½•é”™è¯¯ï¼Œè¯·æ‰¹è¯„æŒ‡æ•™ï¼Œä¸èƒœæ„Ÿæ¿€ ï¼
